var dataList,len,control,timer,root=window.player,audio=root.audioManager,listStatus=!0;function getData(o){$.ajax({type:"GET",url:o,success:function(o){void 0,len=(dataList=o).length,control=new root.controlIndex(len),root.render(o[0]),audio.getAudio(o[0].audio),bindEvent(),bindTouch(),autoChange(),renderSongList(),$("body").trigger("play:change",0)},error:function(o){void 0}})}function bindEvent(){$("body").on("play:change",function(o,t){audio.getAudio(dataList[t].audio),root.render(dataList[t]),"play"==audio.status&&(audio.play(),rotated(0)),$(".img-box").attr("data-deg",0),$(".img-box").css({transform:"rotateZ(0deg)",transiton:"none"}),root.pro.renderAllTime(dataList[t].duration)}),$(".prev").on("click",function(){var o=control.prev();$("body").trigger("play:change",o),root.pro.start(0),"pause"==audio.status&&(audio.pause(),root.pro.stop())}),$(".next").on("click",function(){var o=control.next();$("body").trigger("play:change",o),root.pro.start(0),"pause"==audio.status&&(audio.pause(),root.pro.stop())}),$(".play").on("click",function(){"pause"==audio.status?(audio.play(),root.pro.start(),rotated($(".img-box").attr("data-deg")||0)):(audio.pause(),root.pro.stop(),clearInterval(timer)),$(".play").toggleClass("playing")}),clickChange($(".pro-bottom")),clickChange($(".pro-top")),$(".list").on("click",function(){listStatus=listStatus?($(".list-song").show(),!1):($(".list-song").hide(),!0)}),$(".close").on("click",function(){$(".list-song").hide(),listStatus=!0})}function autoChange(){audio.audio.addEventListener("ended",function(){var o=control.next();$("body").trigger("play:change",o),root.pro.start(0)},!1)}function clickChange(o){o.on("click",function(o){var t=o.clientX,a=$(".pro-bottom").offset(),n=(t-a.left)/a.width,i=n*dataList[control.index].duration;0<n&&n<1&&(audio.playTo(i),audio.status="play",audio.play(),$(".play").addClass("playing"),root.pro.start(n))})}function rotated(o){clearInterval(timer),o=+o,timer=setInterval(function(){o+=.5,$(".img-box").attr("data-deg",o),$(".img-box").css({transform:"rotateZ("+o+"deg)",transiton:"all 1s ease-out"})},1e3/60)}function bindTouch(){var o=$(".spot"),t=$(".pro-bottom").offset(),n=t.left,i=t.width;o.on("touchstart",function(){root.pro.stop(),audio.pause()}).on("touchmove",function(o){var t=(o.changedTouches[0].clientX-n)/i;0<t&&t<1&&root.pro.updata(t)}).on("touchend",function(o){var t,a=(o.changedTouches[0].clientX-n)/i;0<a&&a<1&&(t=a*dataList[control.index].duration,audio.playTo(t),audio.status="play",audio.play(),$(".play").addClass("playing"),root.pro.start(a))})}function renderSongList(){var n=$(".list-song-ul");dataList.forEach(function(o,t){var a='            <li>            <img  class="img" src="'+o.image+'" alt="">            <span class="song">'+o.song+'</span>            <span class="singer">- '+o.singer+'</span>            <span class="time">'+root.pro.formatTime(o.duration)+"</span>            </li>        ";$(a).appendTo(n),$(n.children()[t]).on("click",function(){audio.play(),$("body").trigger("play:change",t),root.pro.start(0),$(".play").addClass("playing"),$(".list-song-ul li").removeClass("clicked"),$(this).addClass("clicked")})})}getData("./../mock/data.json");